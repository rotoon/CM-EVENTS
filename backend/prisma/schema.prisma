generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model event_images {
  id         Int       @id @default(autoincrement())
  event_id   Int?
  image_url  String
  created_at DateTime? @default(now()) @db.Timestamp(6)
  events     events?   @relation(fields: [event_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model events {
  id                   Int            @id @default(autoincrement())
  source_url           String         @unique
  title                String
  description          String?
  location             String?
  date_text            String?
  month_wrapped        String?
  cover_image_url      String?
  first_scraped_at     DateTime?      @default(now()) @db.Timestamp(6)
  last_updated_at      DateTime?      @default(now()) @db.Timestamp(6)
  is_fully_scraped     Boolean?       @default(false)
  time_text            String?
  latitude             Float?         @db.Real
  longitude            Float?         @db.Real
  google_maps_url      String?
  facebook_url         String?
  is_ended             Boolean?       @default(false)
  description_markdown String?
  start_date           DateTime?      @db.Date
  end_date             DateTime?      @db.Date
  event_images         event_images[]
}

// ==================== PLACES (ร้านอาหาร/คาเฟ่) ====================

model places {
  id              Int                @id @default(autoincrement())
  name            String
  place_type      String // Cafe, Food, Restaurant, Travel, Bar/Nightlife
  description     String? // Caption จาก Instagram
  instagram_url   String?            @unique
  likes           Int?               @default(0)
  comments        Int?               @default(0)
  latitude        Float?             @db.Real
  longitude       Float?             @db.Real
  google_maps_url String?
  google_place_id String?
  cover_image_url String?
  post_date       DateTime?          @db.Timestamp(6)
  created_at      DateTime?          @default(now()) @db.Timestamp(6)
  updated_at      DateTime?          @default(now()) @db.Timestamp(6)
  categories      place_categories[]
}

model place_categories {
  id       Int    @id @default(autoincrement())
  place_id Int
  category String
  place    places @relation(fields: [place_id], references: [id], onDelete: Cascade)

  @@unique([place_id, category])
  @@index([category])
}
